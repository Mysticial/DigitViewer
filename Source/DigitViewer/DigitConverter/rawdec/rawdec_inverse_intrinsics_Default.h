/* rawdec_inverse_intrinsics_Default.h
 * 
 * Author           : Alexander J. Yee
 * Date Created     : 01/30/2011
 * Last Modified    : 01/24/2016
 * 
 */

#ifndef ydv_DigitViewer_rawdec_inverse_intrinsics_Default_H
#define ydv_DigitViewer_rawdec_inverse_intrinsics_Default_H
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
#include "PublicLibs/CompilerSettings.h"
#include "PublicLibs/Types.h"
namespace DigitViewer{
namespace rawdec{
    using namespace ymp;
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
YM_FORCE_INLINE char convert_dec1_inverse_Default(char str[1]){
    char bad;
    char r0 = str[0];
    bad  = r0 < '0' || r0 > '9' ? 1 : 0;
    r0 -= '0';
    str[0] = r0;
    return bad;
}
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
YM_FORCE_INLINE u32_t convert_dec4_inverse_Default32(char str[4]){
    u32_t* T = (u32_t*)str;

    u32_t bad;
    u32_t a0, b0;

    a0 = T[0];

    b0 = a0 & 0x80808080ull;
    bad = b0;

    b0 = a0 + 0x46464646ull;
    b0 &= 0x80808080ull;
    bad |= b0;

    b0 = a0 + 0x50505050ull;
    b0 = ~b0;
    b0 &= 0x80808080ull;
    bad |= b0;

    a0 -= 0x30303030ull;
    T[0] = a0;

    return bad;
}
YM_FORCE_INLINE u32_t convert_dec8_inverse_Default32(char str[8]){
    u32_t* T = (u32_t*)str;

    u32_t bad;
    u32_t a0, b0;
    u32_t a1, b1;

    a0 = T[0];
    a1 = T[1];

    b0 = a0 & 0x80808080ull;
    b1 = a1 & 0x80808080ull;
    bad  = b0;
    bad |= b1;

    b0 = a0 + 0x46464646ull;
    b1 = a1 + 0x46464646ull;
    b0 &= 0x80808080ull;
    b1 &= 0x80808080ull;
    bad |= b0;
    bad |= b1;

    b0 = a0 + 0x50505050ull;
    b1 = a1 + 0x50505050ull;
    b0 = ~b0;
    b1 = ~b1;
    b0 &= 0x80808080ull;
    b1 &= 0x80808080ull;
    bad |= b0;
    bad |= b1;

    a0 -= 0x30303030ull;
    a1 -= 0x30303030ull;
    T[0] = a0;
    T[1] = a1;

    return bad;
}
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
}
}
#endif
